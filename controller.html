<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Websocket Example</title>
</head>
<body>
    <div class="controller">
        <div class="input">
            <button id="back"onclick="sendMessage('back')">back</button>
            <button id="next"onclick="sendMessage('next')">next</button>
        </div>
        <hr>
        <div id="output"></div>
    </div>
</body>
    <script>
        var slide;
        var presLength;
        var init = async () => {
            var response = await fetch(`/slideinfo/`)
            var json = await response.json();
            presLength = json.presLength;
            slide = Number(json.slide);
            document.getElementById('next').disabled = slide == Number(presLength)
            document.getElementById('back').disabled = slide == 1
            return;
        }
        const socket = new WebSocket('ws://localhost:3000');
        
        socket.onmessage = async (event) => {
            if(!presLength){
                await init();
            }
            console.log(`Recieved: ${event.data}`);
            const output = document.getElementById('output');
            var slide = Number(event.data);
            console.log(slide, presLength)
            console.log("next", slide==presLength);
            console.log("back",slide == 1);

            output.innerHTML = `<p> Set current Slide to: ${event.data}/${presLength} </p>`;
        }

        async function sendMessage(direction) {
            
            if(direction=="next"){
                slide += 1;
            } else {
                slide += -1;
            }
            socket.send(slide);
            document.getElementById('next').disabled = slide == Number(presLength)
            document.getElementById('back').disabled = slide == 1
        }
    </script>
</html>  